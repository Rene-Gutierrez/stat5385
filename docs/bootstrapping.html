<!DOCTYPE html>
<html lang="" xml:lang="">
<head>

  <meta charset="utf-8" />
  <meta http-equiv="X-UA-Compatible" content="IE=edge" />
  <title>7 Bootstrapping | _main.knit</title>
  <meta name="description" content="" />
  <meta name="generator" content="bookdown 0.40 and GitBook 2.6.7" />

  <meta property="og:title" content="7 Bootstrapping | _main.knit" />
  <meta property="og:type" content="book" />
  
  
  

  <meta name="twitter:card" content="summary" />
  <meta name="twitter:title" content="7 Bootstrapping | _main.knit" />
  
  
  




  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <meta name="apple-mobile-web-app-capable" content="yes" />
  <meta name="apple-mobile-web-app-status-bar-style" content="black" />
  
  
<link rel="prev" href="multiple-linear-regression.html"/>
<link rel="next" href="mean-and-varaince-assumptions.html"/>
<script src="libs/jquery-3.6.0/jquery-3.6.0.min.js"></script>
<script src="https://cdn.jsdelivr.net/npm/fuse.js@6.4.6/dist/fuse.min.js"></script>
<link href="libs/gitbook-2.6.7/css/style.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-table.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-bookdown.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-highlight.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-search.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-fontsettings.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-clipboard.css" rel="stylesheet" />








<link href="libs/anchor-sections-1.1.0/anchor-sections.css" rel="stylesheet" />
<link href="libs/anchor-sections-1.1.0/anchor-sections-hash.css" rel="stylesheet" />
<script src="libs/anchor-sections-1.1.0/anchor-sections.js"></script>


<style type="text/css">
html { -webkit-text-size-adjust: 100%; }
pre > code.sourceCode { white-space: pre; position: relative; }
pre > code.sourceCode > span { display: inline-block; line-height: 1.25; }
pre > code.sourceCode > span:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode > span { color: inherit; text-decoration: inherit; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
pre > code.sourceCode { white-space: pre-wrap; }
pre > code.sourceCode > span { text-indent: -5em; padding-left: 5em; }
}
pre.numberSource code
  { counter-reset: source-line 0; }
pre.numberSource code > span
  { position: relative; left: -4em; counter-increment: source-line; }
pre.numberSource code > span > a:first-child::before
  { content: counter(source-line);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
    color: #aaaaaa;
  }
pre.numberSource { margin-left: 3em; border-left: 1px solid #aaaaaa;  padding-left: 4px; }
div.sourceCode
  {   }
@media screen {
pre > code.sourceCode > span > a:first-child::before { text-decoration: underline; }
}
code span.al { color: #ff0000; font-weight: bold; } /* Alert */
code span.an { color: #60a0b0; font-weight: bold; font-style: italic; } /* Annotation */
code span.at { color: #7d9029; } /* Attribute */
code span.bn { color: #40a070; } /* BaseN */
code span.bu { color: #008000; } /* BuiltIn */
code span.cf { color: #007020; font-weight: bold; } /* ControlFlow */
code span.ch { color: #4070a0; } /* Char */
code span.cn { color: #880000; } /* Constant */
code span.co { color: #60a0b0; font-style: italic; } /* Comment */
code span.cv { color: #60a0b0; font-weight: bold; font-style: italic; } /* CommentVar */
code span.do { color: #ba2121; font-style: italic; } /* Documentation */
code span.dt { color: #902000; } /* DataType */
code span.dv { color: #40a070; } /* DecVal */
code span.er { color: #ff0000; font-weight: bold; } /* Error */
code span.ex { } /* Extension */
code span.fl { color: #40a070; } /* Float */
code span.fu { color: #06287e; } /* Function */
code span.im { color: #008000; font-weight: bold; } /* Import */
code span.in { color: #60a0b0; font-weight: bold; font-style: italic; } /* Information */
code span.kw { color: #007020; font-weight: bold; } /* Keyword */
code span.op { color: #666666; } /* Operator */
code span.ot { color: #007020; } /* Other */
code span.pp { color: #bc7a00; } /* Preprocessor */
code span.sc { color: #4070a0; } /* SpecialChar */
code span.ss { color: #bb6688; } /* SpecialString */
code span.st { color: #4070a0; } /* String */
code span.va { color: #19177c; } /* Variable */
code span.vs { color: #4070a0; } /* VerbatimString */
code span.wa { color: #60a0b0; font-weight: bold; font-style: italic; } /* Warning */
</style>

<style type="text/css">
  
  div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
</style>

</head>

<body>



  <div class="book without-animation with-summary font-size-2 font-family-1" data-basepath=".">

    <div class="book-summary">
      <nav role="navigation">

<ul class="summary">
<li class="chapter" data-level="1" data-path="index.html"><a href="index.html"><i class="fa fa-check"></i><b>1</b> Stat 5385/6385 Fall 2025</a>
<ul>
<li class="chapter" data-level="1.1" data-path="index.html"><a href="index.html#calendar"><i class="fa fa-check"></i><b>1.1</b> Calendar</a>
<ul>
<li class="chapter" data-level="1.1.1" data-path="index.html"><a href="index.html#important-dates"><i class="fa fa-check"></i><b>1.1.1</b> Important Dates</a></li>
<li class="chapter" data-level="1.1.2" data-path="index.html"><a href="index.html#class-schedule"><i class="fa fa-check"></i><b>1.1.2</b> Class Schedule</a></li>
</ul></li>
<li class="chapter" data-level="1.2" data-path="index.html"><a href="index.html#course-overview"><i class="fa fa-check"></i><b>1.2</b> Course Overview</a>
<ul>
<li class="chapter" data-level="1.2.1" data-path="index.html"><a href="index.html#chapter-2-mathematical-prerequisites"><i class="fa fa-check"></i><b>1.2.1</b> Chapter 2 — Mathematical Prerequisites</a></li>
<li class="chapter" data-level="1.2.2" data-path="index.html"><a href="index.html#chapter-3-the-linear-regression-problem"><i class="fa fa-check"></i><b>1.2.2</b> Chapter 3 — The Linear Regression Problem</a></li>
<li class="chapter" data-level="1.2.3" data-path="index.html"><a href="index.html#chapters-4-to-6-linear-regression-as-an-optimization-problem"><i class="fa fa-check"></i><b>1.2.3</b> Chapters 4 to 6 — Linear Regression as an Optimization Problem</a></li>
<li class="chapter" data-level="1.2.4" data-path="index.html"><a href="index.html#chapter-7-introducing-uncertainty"><i class="fa fa-check"></i><b>1.2.4</b> Chapter 7 — Introducing Uncertainty</a></li>
<li class="chapter" data-level="1.2.5" data-path="index.html"><a href="index.html#chapters-8-and-9-probabilistic-modeling-and-statistical-inference"><i class="fa fa-check"></i><b>1.2.5</b> Chapters 8 and 9 — Probabilistic Modeling and Statistical Inference</a></li>
<li class="chapter" data-level="1.2.6" data-path="index.html"><a href="index.html#summary"><i class="fa fa-check"></i><b>1.2.6</b> Summary</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="2" data-path="prerequisites.html"><a href="prerequisites.html"><i class="fa fa-check"></i><b>2</b> Prerequisites</a>
<ul>
<li class="chapter" data-level="2.1" data-path="prerequisites.html"><a href="prerequisites.html#general-math"><i class="fa fa-check"></i><b>2.1</b> General Math</a></li>
<li class="chapter" data-level="2.2" data-path="prerequisites.html"><a href="prerequisites.html#linear-algebra"><i class="fa fa-check"></i><b>2.2</b> Linear Algebra</a>
<ul>
<li class="chapter" data-level="2.2.1" data-path="prerequisites.html"><a href="prerequisites.html#zero-matrix"><i class="fa fa-check"></i><b>2.2.1</b> Zero Matrix</a></li>
<li class="chapter" data-level="2.2.2" data-path="prerequisites.html"><a href="prerequisites.html#linear-independence"><i class="fa fa-check"></i><b>2.2.2</b> Linear Independence</a></li>
<li class="chapter" data-level="2.2.3" data-path="prerequisites.html"><a href="prerequisites.html#column-space-of-a-matrix"><i class="fa fa-check"></i><b>2.2.3</b> Column Space of a Matrix</a></li>
<li class="chapter" data-level="2.2.4" data-path="prerequisites.html"><a href="prerequisites.html#rank-of-a-matrix"><i class="fa fa-check"></i><b>2.2.4</b> Rank of a Matrix</a></li>
<li class="chapter" data-level="2.2.5" data-path="prerequisites.html"><a href="prerequisites.html#full-rank-matrix"><i class="fa fa-check"></i><b>2.2.5</b> Full Rank Matrix</a></li>
<li class="chapter" data-level="2.2.6" data-path="prerequisites.html"><a href="prerequisites.html#inverse-matrix"><i class="fa fa-check"></i><b>2.2.6</b> Inverse Matrix</a></li>
<li class="chapter" data-level="2.2.7" data-path="prerequisites.html"><a href="prerequisites.html#positive-definite-matrix"><i class="fa fa-check"></i><b>2.2.7</b> Positive Definite Matrix</a></li>
<li class="chapter" data-level="2.2.8" data-path="prerequisites.html"><a href="prerequisites.html#singular-value-decomposition"><i class="fa fa-check"></i><b>2.2.8</b> Singular Value Decomposition</a></li>
<li class="chapter" data-level="2.2.9" data-path="prerequisites.html"><a href="prerequisites.html#eigendecomposition"><i class="fa fa-check"></i><b>2.2.9</b> Eigendecomposition</a></li>
<li class="chapter" data-level="2.2.10" data-path="prerequisites.html"><a href="prerequisites.html#idempotent-matrix"><i class="fa fa-check"></i><b>2.2.10</b> Idempotent Matrix</a></li>
<li class="chapter" data-level="2.2.11" data-path="prerequisites.html"><a href="prerequisites.html#determinant-of-a-matrix"><i class="fa fa-check"></i><b>2.2.11</b> Determinant of a Matrix</a></li>
<li class="chapter" data-level="2.2.12" data-path="prerequisites.html"><a href="prerequisites.html#trace-of-a-matrix"><i class="fa fa-check"></i><b>2.2.12</b> Trace of a Matrix</a></li>
</ul></li>
<li class="chapter" data-level="2.3" data-path="prerequisites.html"><a href="prerequisites.html#calculus"><i class="fa fa-check"></i><b>2.3</b> Calculus</a>
<ul>
<li class="chapter" data-level="2.3.1" data-path="prerequisites.html"><a href="prerequisites.html#gradient"><i class="fa fa-check"></i><b>2.3.1</b> Gradient</a></li>
<li class="chapter" data-level="2.3.2" data-path="prerequisites.html"><a href="prerequisites.html#hessian-matrix"><i class="fa fa-check"></i><b>2.3.2</b> Hessian Matrix</a></li>
<li class="chapter" data-level="2.3.3" data-path="prerequisites.html"><a href="prerequisites.html#applications-1"><i class="fa fa-check"></i><b>2.3.3</b> Applications:</a></li>
<li class="chapter" data-level="2.3.4" data-path="prerequisites.html"><a href="prerequisites.html#matrix-calculus"><i class="fa fa-check"></i><b>2.3.4</b> Matrix Calculus</a></li>
</ul></li>
<li class="chapter" data-level="2.4" data-path="prerequisites.html"><a href="prerequisites.html#probability"><i class="fa fa-check"></i><b>2.4</b> Probability</a>
<ul>
<li class="chapter" data-level="2.4.1" data-path="prerequisites.html"><a href="prerequisites.html#expected-value"><i class="fa fa-check"></i><b>2.4.1</b> Expected Value</a></li>
<li class="chapter" data-level="2.4.2" data-path="prerequisites.html"><a href="prerequisites.html#variance"><i class="fa fa-check"></i><b>2.4.2</b> Variance</a></li>
<li class="chapter" data-level="2.4.3" data-path="prerequisites.html"><a href="prerequisites.html#cross-covariance-matrix"><i class="fa fa-check"></i><b>2.4.3</b> Cross-Covariance Matrix</a></li>
<li class="chapter" data-level="2.4.4" data-path="prerequisites.html"><a href="prerequisites.html#multivariate-normal-distribution"><i class="fa fa-check"></i><b>2.4.4</b> Multivariate Normal Distribution</a></li>
<li class="chapter" data-level="2.4.5" data-path="prerequisites.html"><a href="prerequisites.html#chi2-distribution"><i class="fa fa-check"></i><b>2.4.5</b> <span class="math inline">\(\chi^2\)</span> Distribution</a></li>
<li class="chapter" data-level="2.4.6" data-path="prerequisites.html"><a href="prerequisites.html#t-distribution"><i class="fa fa-check"></i><b>2.4.6</b> <span class="math inline">\(t\)</span> Distribution</a></li>
<li class="chapter" data-level="2.4.7" data-path="prerequisites.html"><a href="prerequisites.html#f-distribution"><i class="fa fa-check"></i><b>2.4.7</b> <span class="math inline">\(F\)</span> Distribution</a></li>
</ul></li>
<li class="chapter" data-level="2.5" data-path="prerequisites.html"><a href="prerequisites.html#statistics"><i class="fa fa-check"></i><b>2.5</b> Statistics</a>
<ul>
<li class="chapter" data-level="2.5.1" data-path="prerequisites.html"><a href="prerequisites.html#bias-of-an-estimator"><i class="fa fa-check"></i><b>2.5.1</b> Bias of an Estimator</a></li>
<li class="chapter" data-level="2.5.2" data-path="prerequisites.html"><a href="prerequisites.html#unbiased-estimator"><i class="fa fa-check"></i><b>2.5.2</b> Unbiased Estimator</a></li>
<li class="chapter" data-level="2.5.3" data-path="prerequisites.html"><a href="prerequisites.html#mean-square-error-of-an-estimator"><i class="fa fa-check"></i><b>2.5.3</b> Mean Square Error of an Estimator</a></li>
<li class="chapter" data-level="2.5.4" data-path="prerequisites.html"><a href="prerequisites.html#interval-estimation"><i class="fa fa-check"></i><b>2.5.4</b> Interval Estimation</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="3" data-path="introduction.html"><a href="introduction.html"><i class="fa fa-check"></i><b>3</b> Introduction</a>
<ul>
<li class="chapter" data-level="3.1" data-path="introduction.html"><a href="introduction.html#objectives-of-linear-regression"><i class="fa fa-check"></i><b>3.1</b> Objectives of Linear Regression</a></li>
<li class="chapter" data-level="3.2" data-path="introduction.html"><a href="introduction.html#examples-1"><i class="fa fa-check"></i><b>3.2</b> Examples</a>
<ul>
<li class="chapter" data-level="3.2.1" data-path="introduction.html"><a href="introduction.html#ad-spending"><i class="fa fa-check"></i><b>3.2.1</b> Ad Spending</a></li>
<li class="chapter" data-level="3.2.2" data-path="introduction.html"><a href="introduction.html#winw-example"><i class="fa fa-check"></i><b>3.2.2</b> Wine and Life Expectancy</a></li>
<li class="chapter" data-level="3.2.3" data-path="introduction.html"><a href="introduction.html#burger-demand"><i class="fa fa-check"></i><b>3.2.3</b> Burger Demand</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="4" data-path="simple-linear-regression.html"><a href="simple-linear-regression.html"><i class="fa fa-check"></i><b>4</b> Simple Linear Regression</a>
<ul>
<li class="chapter" data-level="4.1" data-path="simple-linear-regression.html"><a href="simple-linear-regression.html#intro-to-slr"><i class="fa fa-check"></i><b>4.1</b> Intro to SLR</a>
<ul>
<li class="chapter" data-level="4.1.1" data-path="simple-linear-regression.html"><a href="simple-linear-regression.html#a-path-not-taken"><i class="fa fa-check"></i><b>4.1.1</b> A path not Taken</a></li>
<li class="chapter" data-level="4.1.2" data-path="simple-linear-regression.html"><a href="simple-linear-regression.html#slr-model"><i class="fa fa-check"></i><b>4.1.2</b> SLR Model</a></li>
<li class="chapter" data-level="4.1.3" data-path="simple-linear-regression.html"><a href="simple-linear-regression.html#possible-optimization-problems"><i class="fa fa-check"></i><b>4.1.3</b> Possible Optimization Problems</a></li>
</ul></li>
<li class="chapter" data-level="4.2" data-path="simple-linear-regression.html"><a href="simple-linear-regression.html#least-squares-estimation"><i class="fa fa-check"></i><b>4.2</b> Least Squares Estimation</a>
<ul>
<li class="chapter" data-level="4.2.1" data-path="simple-linear-regression.html"><a href="simple-linear-regression.html#other-estimated-quantites"><i class="fa fa-check"></i><b>4.2.1</b> Other estimated quantites</a></li>
<li class="chapter" data-level="4.2.2" data-path="simple-linear-regression.html"><a href="simple-linear-regression.html#properties-of-the-slr-problem"><i class="fa fa-check"></i><b>4.2.2</b> Properties of the SLR problem</a></li>
</ul></li>
<li class="chapter" data-level="4.3" data-path="simple-linear-regression.html"><a href="simple-linear-regression.html#properties-of-the-estimates"><i class="fa fa-check"></i><b>4.3</b> Properties of the Estimates</a>
<ul>
<li class="chapter" data-level="4.3.1" data-path="simple-linear-regression.html"><a href="simple-linear-regression.html#hatbeta_0-and-hatbeta_1-are-linear-combinations-of"><i class="fa fa-check"></i><b>4.3.1</b> <span class="math inline">\(\hat{\beta}_0\)</span> and <span class="math inline">\(\hat{\beta}_1\)</span> are linear combinations of</a></li>
<li class="chapter" data-level="4.3.2" data-path="simple-linear-regression.html"><a href="simple-linear-regression.html#the-sum-of-the-residuals-is-0"><i class="fa fa-check"></i><b>4.3.2</b> The sum of the residuals is <span class="math inline">\(0\)</span></a></li>
<li class="chapter" data-level="4.3.3" data-path="simple-linear-regression.html"><a href="simple-linear-regression.html#hatmathbfe-and-mathbfx-are-orthogonal"><i class="fa fa-check"></i><b>4.3.3</b> <span class="math inline">\(\hat{\mathbf{e}}\)</span> and <span class="math inline">\(\mathbf{x}\)</span> are orthogonal</a></li>
<li class="chapter" data-level="4.3.4" data-path="simple-linear-regression.html"><a href="simple-linear-regression.html#hatmathbfy-and-hatmathbfe-are-orthogonal"><i class="fa fa-check"></i><b>4.3.4</b> <span class="math inline">\(\hat{\mathbf{y}}\)</span> and <span class="math inline">\(\hat{\mathbf{e}}\)</span> are orthogonal</a></li>
<li class="chapter" data-level="4.3.5" data-path="simple-linear-regression.html"><a href="simple-linear-regression.html#the-average-of-hatmathbfy-and-mathbfy-are-the-same"><i class="fa fa-check"></i><b>4.3.5</b> The average of <span class="math inline">\(\hat{\mathbf{y}}\)</span> and <span class="math inline">\(\mathbf{y}\)</span> are the same</a></li>
</ul></li>
<li class="chapter" data-level="4.4" data-path="simple-linear-regression.html"><a href="simple-linear-regression.html#centering-and-standarizing-the-data"><i class="fa fa-check"></i><b>4.4</b> Centering and Standarizing the Data</a>
<ul>
<li class="chapter" data-level="4.4.1" data-path="simple-linear-regression.html"><a href="simple-linear-regression.html#remarks-on-centering-and-standarization"><i class="fa fa-check"></i><b>4.4.1</b> Remarks on Centering and Standarization</a></li>
<li class="chapter" data-level="4.4.2" data-path="simple-linear-regression.html"><a href="simple-linear-regression.html#summary-centering-and-standarizing"><i class="fa fa-check"></i><b>4.4.2</b> Summary Centering and Standarizing</a></li>
</ul></li>
<li class="chapter" data-level="4.5" data-path="simple-linear-regression.html"><a href="simple-linear-regression.html#centering-and-standarizing-in-slr"><i class="fa fa-check"></i><b>4.5</b> Centering and Standarizing in SLR</a>
<ul>
<li class="chapter" data-level="4.5.1" data-path="simple-linear-regression.html"><a href="simple-linear-regression.html#centered-independent-variable"><i class="fa fa-check"></i><b>4.5.1</b> Centered Independent Variable</a></li>
<li class="chapter" data-level="4.5.2" data-path="simple-linear-regression.html"><a href="simple-linear-regression.html#both-variables-centered"><i class="fa fa-check"></i><b>4.5.2</b> Both Variables Centered</a></li>
<li class="chapter" data-level="4.5.3" data-path="simple-linear-regression.html"><a href="simple-linear-regression.html#both-variables-standarized"><i class="fa fa-check"></i><b>4.5.3</b> Both variables Standarized</a></li>
<li class="chapter" data-level="4.5.4" data-path="simple-linear-regression.html"><a href="simple-linear-regression.html#summary-of-centering-and-standarizing-in-slr"><i class="fa fa-check"></i><b>4.5.4</b> Summary of Centering and Standarizing in SLR</a></li>
</ul></li>
<li class="chapter" data-level="4.6" data-path="simple-linear-regression.html"><a href="simple-linear-regression.html#coefficient-of-determination"><i class="fa fa-check"></i><b>4.6</b> Coefficient of Determination</a></li>
<li class="chapter" data-level="4.7" data-path="simple-linear-regression.html"><a href="simple-linear-regression.html#residual-analysis"><i class="fa fa-check"></i><b>4.7</b> Residual Analysis</a>
<ul>
<li class="chapter" data-level="4.7.1" data-path="simple-linear-regression.html"><a href="simple-linear-regression.html#non-linear-regression-function"><i class="fa fa-check"></i><b>4.7.1</b> Non-linear regression function</a></li>
<li class="chapter" data-level="4.7.2" data-path="simple-linear-regression.html"><a href="simple-linear-regression.html#heteroscedasticity"><i class="fa fa-check"></i><b>4.7.2</b> Heteroscedasticity</a></li>
<li class="chapter" data-level="4.7.3" data-path="simple-linear-regression.html"><a href="simple-linear-regression.html#outliers"><i class="fa fa-check"></i><b>4.7.3</b> Outliers</a></li>
<li class="chapter" data-level="4.7.4" data-path="simple-linear-regression.html"><a href="simple-linear-regression.html#variables-ommited"><i class="fa fa-check"></i><b>4.7.4</b> Variables Ommited</a></li>
</ul></li>
<li class="chapter" data-level="4.8" data-path="simple-linear-regression.html"><a href="simple-linear-regression.html#cross-validation"><i class="fa fa-check"></i><b>4.8</b> Cross-Validation</a></li>
<li class="chapter" data-level="4.9" data-path="simple-linear-regression.html"><a href="simple-linear-regression.html#weighted-least-squares"><i class="fa fa-check"></i><b>4.9</b> Weighted Least Squares</a></li>
<li class="chapter" data-level="4.10" data-path="simple-linear-regression.html"><a href="simple-linear-regression.html#model-in-matrix-form"><i class="fa fa-check"></i><b>4.10</b> Model in Matrix Form</a>
<ul>
<li class="chapter" data-level="4.10.1" data-path="simple-linear-regression.html"><a href="simple-linear-regression.html#weighted-least-squares-in-matrix-form"><i class="fa fa-check"></i><b>4.10.1</b> Weighted Least Squares in Matrix Form</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="5" data-path="polynomial-regression.html"><a href="polynomial-regression.html"><i class="fa fa-check"></i><b>5</b> Polynomial Regression</a>
<ul>
<li class="chapter" data-level="5.1" data-path="polynomial-regression.html"><a href="polynomial-regression.html#motivation"><i class="fa fa-check"></i><b>5.1</b> Motivation</a>
<ul>
<li class="chapter" data-level="5.1.1" data-path="polynomial-regression.html"><a href="polynomial-regression.html#taylor-polynomials-and-polynomial-regression"><i class="fa fa-check"></i><b>5.1.1</b> Taylor polynomials and polynomial regression</a></li>
</ul></li>
<li class="chapter" data-level="5.2" data-path="polynomial-regression.html"><a href="polynomial-regression.html#why-use-the-sample-mean-as-the-expansion-center-point"><i class="fa fa-check"></i><b>5.2</b> Why use the sample mean as the expansion (center) point?</a>
<ul>
<li class="chapter" data-level="5.2.1" data-path="polynomial-regression.html"><a href="polynomial-regression.html#examples-2"><i class="fa fa-check"></i><b>5.2.1</b> Examples</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="6" data-path="multiple-linear-regression.html"><a href="multiple-linear-regression.html"><i class="fa fa-check"></i><b>6</b> Multiple Linear Regression</a>
<ul>
<li class="chapter" data-level="6.1" data-path="multiple-linear-regression.html"><a href="multiple-linear-regression.html#introduction-1"><i class="fa fa-check"></i><b>6.1</b> Introduction</a>
<ul>
<li class="chapter" data-level="6.1.1" data-path="multiple-linear-regression.html"><a href="multiple-linear-regression.html#the-general-model"><i class="fa fa-check"></i><b>6.1.1</b> The General Model</a></li>
<li class="chapter" data-level="6.1.2" data-path="multiple-linear-regression.html"><a href="multiple-linear-regression.html#interpretation-and-objectives"><i class="fa fa-check"></i><b>6.1.2</b> Interpretation and Objectives</a></li>
<li class="chapter" data-level="6.1.3" data-path="multiple-linear-regression.html"><a href="multiple-linear-regression.html#applications-and-context"><i class="fa fa-check"></i><b>6.1.3</b> Applications and Context</a></li>
<li class="chapter" data-level="6.1.4" data-path="multiple-linear-regression.html"><a href="multiple-linear-regression.html#connection-to-polynomial-regression"><i class="fa fa-check"></i><b>6.1.4</b> Connection to Polynomial Regression</a></li>
</ul></li>
<li class="chapter" data-level="6.2" data-path="multiple-linear-regression.html"><a href="multiple-linear-regression.html#example-modeling-gdp"><i class="fa fa-check"></i><b>6.2</b> Example: Modeling GDP</a>
<ul>
<li class="chapter" data-level="6.2.1" data-path="multiple-linear-regression.html"><a href="multiple-linear-regression.html#simple-regressions"><i class="fa fa-check"></i><b>6.2.1</b> Simple Regressions</a></li>
<li class="chapter" data-level="6.2.2" data-path="multiple-linear-regression.html"><a href="multiple-linear-regression.html#multiple-regression"><i class="fa fa-check"></i><b>6.2.2</b> Multiple Regression</a></li>
<li class="chapter" data-level="6.2.3" data-path="multiple-linear-regression.html"><a href="multiple-linear-regression.html#summary-2"><i class="fa fa-check"></i><b>6.2.3</b> Summary</a></li>
</ul></li>
<li class="chapter" data-level="6.3" data-path="multiple-linear-regression.html"><a href="multiple-linear-regression.html#least-squares-estimation-1"><i class="fa fa-check"></i><b>6.3</b> Least Squares Estimation</a></li>
<li class="chapter" data-level="6.4" data-path="multiple-linear-regression.html"><a href="multiple-linear-regression.html#properties-of-the-estimates-1"><i class="fa fa-check"></i><b>6.4</b> Properties of the Estimates</a></li>
<li class="chapter" data-level="6.5" data-path="multiple-linear-regression.html"><a href="multiple-linear-regression.html#multiple-r2"><i class="fa fa-check"></i><b>6.5</b> Multiple <span class="math inline">\(R^2\)</span></a></li>
<li class="chapter" data-level="6.6" data-path="multiple-linear-regression.html"><a href="multiple-linear-regression.html#geometric-interpretation-of-multiple-linear-regression"><i class="fa fa-check"></i><b>6.6</b> Geometric Interpretation of Multiple Linear Regression</a></li>
<li class="chapter" data-level="6.7" data-path="multiple-linear-regression.html"><a href="multiple-linear-regression.html#centered-and-standarized-variables"><i class="fa fa-check"></i><b>6.7</b> Centered and Standarized Variables</a>
<ul>
<li class="chapter" data-level="6.7.1" data-path="multiple-linear-regression.html"><a href="multiple-linear-regression.html#centered-variables"><i class="fa fa-check"></i><b>6.7.1</b> Centered Variables</a></li>
<li class="chapter" data-level="6.7.2" data-path="multiple-linear-regression.html"><a href="multiple-linear-regression.html#sample-covariance"><i class="fa fa-check"></i><b>6.7.2</b> Sample Covariance</a></li>
<li class="chapter" data-level="6.7.3" data-path="multiple-linear-regression.html"><a href="multiple-linear-regression.html#satandard-variables"><i class="fa fa-check"></i><b>6.7.3</b> Satandard Variables</a></li>
<li class="chapter" data-level="6.7.4" data-path="multiple-linear-regression.html"><a href="multiple-linear-regression.html#sample-correlation-matrix"><i class="fa fa-check"></i><b>6.7.4</b> Sample Correlation Matrix</a></li>
</ul></li>
<li class="chapter" data-level="6.8" data-path="multiple-linear-regression.html"><a href="multiple-linear-regression.html#variable-cross-effects"><i class="fa fa-check"></i><b>6.8</b> Variable Cross-Effects</a>
<ul>
<li class="chapter" data-level="6.8.1" data-path="multiple-linear-regression.html"><a href="multiple-linear-regression.html#single-variable-cross-effects"><i class="fa fa-check"></i><b>6.8.1</b> Single Variable Cross-Effects</a></li>
</ul></li>
<li class="chapter" data-level="6.9" data-path="multiple-linear-regression.html"><a href="multiple-linear-regression.html#outliers-and-leverage"><i class="fa fa-check"></i><b>6.9</b> Outliers and Leverage</a>
<ul>
<li class="chapter" data-level="6.9.1" data-path="multiple-linear-regression.html"><a href="multiple-linear-regression.html#leverage"><i class="fa fa-check"></i><b>6.9.1</b> Leverage</a></li>
<li class="chapter" data-level="6.9.2" data-path="multiple-linear-regression.html"><a href="multiple-linear-regression.html#influential-observations"><i class="fa fa-check"></i><b>6.9.2</b> Influential Observations</a></li>
</ul></li>
<li class="chapter" data-level="6.10" data-path="multiple-linear-regression.html"><a href="multiple-linear-regression.html#stability-of-the-solution"><i class="fa fa-check"></i><b>6.10</b> Stability of the Solution</a></li>
<li class="chapter" data-level="6.11" data-path="multiple-linear-regression.html"><a href="multiple-linear-regression.html#other-approaches-to-regression"><i class="fa fa-check"></i><b>6.11</b> Other Approaches to Regression</a>
<ul>
<li class="chapter" data-level="6.11.1" data-path="multiple-linear-regression.html"><a href="multiple-linear-regression.html#least-absolute-error-regression"><i class="fa fa-check"></i><b>6.11.1</b> Least Absolute Error Regression</a></li>
<li class="chapter" data-level="6.11.2" data-path="multiple-linear-regression.html"><a href="multiple-linear-regression.html#ridge-regression"><i class="fa fa-check"></i><b>6.11.2</b> Ridge Regression</a></li>
<li class="chapter" data-level="6.11.3" data-path="multiple-linear-regression.html"><a href="multiple-linear-regression.html#lasso-regression"><i class="fa fa-check"></i><b>6.11.3</b> Lasso Regression</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="7" data-path="bootstrapping.html"><a href="bootstrapping.html"><i class="fa fa-check"></i><b>7</b> Bootstrapping</a>
<ul>
<li class="chapter" data-level="7.1" data-path="bootstrapping.html"><a href="bootstrapping.html#introduction-2"><i class="fa fa-check"></i><b>7.1</b> Introduction</a>
<ul>
<li class="chapter" data-level="7.1.1" data-path="bootstrapping.html"><a href="bootstrapping.html#key-points-6"><i class="fa fa-check"></i><b>7.1.1</b> Key Points</a></li>
</ul></li>
<li class="chapter" data-level="7.2" data-path="bootstrapping.html"><a href="bootstrapping.html#bootstrapping-example"><i class="fa fa-check"></i><b>7.2</b> Bootstrapping Example</a>
<ul>
<li class="chapter" data-level="7.2.1" data-path="bootstrapping.html"><a href="bootstrapping.html#bootstrapping-predictions"><i class="fa fa-check"></i><b>7.2.1</b> Bootstrapping Predictions</a></li>
<li class="chapter" data-level="7.2.2" data-path="bootstrapping.html"><a href="bootstrapping.html#adding-prediction-intervals"><i class="fa fa-check"></i><b>7.2.2</b> Adding Prediction Intervals</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="8" data-path="mean-and-varaince-assumptions.html"><a href="mean-and-varaince-assumptions.html"><i class="fa fa-check"></i><b>8</b> Mean and Varaince Assumptions</a>
<ul>
<li class="chapter" data-level="8.1" data-path="mean-and-varaince-assumptions.html"><a href="mean-and-varaince-assumptions.html#mean-assumptions"><i class="fa fa-check"></i><b>8.1</b> Mean Assumptions</a>
<ul>
<li class="chapter" data-level="8.1.1" data-path="mean-and-varaince-assumptions.html"><a href="mean-and-varaince-assumptions.html#expectation-of-mathbfy"><i class="fa fa-check"></i><b>8.1.1</b> Expectation of <span class="math inline">\(\mathbf{y}\)</span>:</a></li>
<li class="chapter" data-level="8.1.2" data-path="mean-and-varaince-assumptions.html"><a href="mean-and-varaince-assumptions.html#expectation-of-hatboldsymbolbeta"><i class="fa fa-check"></i><b>8.1.2</b> Expectation of <span class="math inline">\(\hat{\boldsymbol{\beta}}\)</span></a></li>
<li class="chapter" data-level="8.1.3" data-path="mean-and-varaince-assumptions.html"><a href="mean-and-varaince-assumptions.html#expectation-of-hatmathbfy"><i class="fa fa-check"></i><b>8.1.3</b> Expectation of <span class="math inline">\(\hat{\mathbf{y}}\)</span></a></li>
<li class="chapter" data-level="8.1.4" data-path="mean-and-varaince-assumptions.html"><a href="mean-and-varaince-assumptions.html#expectation-of-hatmathbfe"><i class="fa fa-check"></i><b>8.1.4</b> Expectation of <span class="math inline">\(\hat{\mathbf{e}}\)</span></a></li>
</ul></li>
<li class="chapter" data-level="8.2" data-path="mean-and-varaince-assumptions.html"><a href="mean-and-varaince-assumptions.html#variance-assumptions"><i class="fa fa-check"></i><b>8.2</b> Variance Assumptions</a>
<ul>
<li class="chapter" data-level="8.2.1" data-path="mean-and-varaince-assumptions.html"><a href="mean-and-varaince-assumptions.html#variance-of-mathbfy"><i class="fa fa-check"></i><b>8.2.1</b> Variance of <span class="math inline">\(\mathbf{y}\)</span></a></li>
<li class="chapter" data-level="8.2.2" data-path="mean-and-varaince-assumptions.html"><a href="mean-and-varaince-assumptions.html#variance-of-hatboldsymbolbeta"><i class="fa fa-check"></i><b>8.2.2</b> Variance of <span class="math inline">\(\hat{\boldsymbol{\beta}}\)</span></a></li>
<li class="chapter" data-level="8.2.3" data-path="mean-and-varaince-assumptions.html"><a href="mean-and-varaince-assumptions.html#variance-of-hatmathbfy"><i class="fa fa-check"></i><b>8.2.3</b> Variance of <span class="math inline">\(\hat{\mathbf{y}}\)</span></a></li>
<li class="chapter" data-level="8.2.4" data-path="mean-and-varaince-assumptions.html"><a href="mean-and-varaince-assumptions.html#variance-of-hatmathbfe"><i class="fa fa-check"></i><b>8.2.4</b> Variance of <span class="math inline">\(\hat{\mathbf{e}}\)</span></a></li>
</ul></li>
<li class="chapter" data-level="8.3" data-path="mean-and-varaince-assumptions.html"><a href="mean-and-varaince-assumptions.html#cross-covariances"><i class="fa fa-check"></i><b>8.3</b> Cross-Covariances</a>
<ul>
<li class="chapter" data-level="8.3.1" data-path="mean-and-varaince-assumptions.html"><a href="mean-and-varaince-assumptions.html#cross-covaraince-of-haty-and-hate"><i class="fa fa-check"></i><b>8.3.1</b> Cross-covaraince of <span class="math inline">\(\hat{y}\)</span> and <span class="math inline">\(\hat{e}\)</span></a></li>
<li class="chapter" data-level="8.3.2" data-path="mean-and-varaince-assumptions.html"><a href="mean-and-varaince-assumptions.html#cross-covaraince-of-haty-and-hatboldsymbolbeta"><i class="fa fa-check"></i><b>8.3.2</b> Cross-covaraince of <span class="math inline">\(\hat{y}\)</span> and <span class="math inline">\(\hat{\boldsymbol{\beta}}\)</span></a></li>
</ul></li>
<li class="chapter" data-level="8.4" data-path="mean-and-varaince-assumptions.html"><a href="mean-and-varaince-assumptions.html#gauss-markov-theorem"><i class="fa fa-check"></i><b>8.4</b> Gauss-Markov Theorem</a>
<ul>
<li class="chapter" data-level="8.4.1" data-path="mean-and-varaince-assumptions.html"><a href="mean-and-varaince-assumptions.html#assumptions"><i class="fa fa-check"></i><b>8.4.1</b> Assumptions</a></li>
<li class="chapter" data-level="8.4.2" data-path="mean-and-varaince-assumptions.html"><a href="mean-and-varaince-assumptions.html#statement"><i class="fa fa-check"></i><b>8.4.2</b> Statement</a></li>
<li class="chapter" data-level="8.4.3" data-path="mean-and-varaince-assumptions.html"><a href="mean-and-varaince-assumptions.html#proof"><i class="fa fa-check"></i><b>8.4.3</b> Proof</a></li>
</ul></li>
<li class="chapter" data-level="8.5" data-path="mean-and-varaince-assumptions.html"><a href="mean-and-varaince-assumptions.html#estimate-of-sigma2"><i class="fa fa-check"></i><b>8.5</b> Estimate of <span class="math inline">\(\sigma^2\)</span></a></li>
</ul></li>
<li class="chapter" data-level="9" data-path="normality-assumption.html"><a href="normality-assumption.html"><i class="fa fa-check"></i><b>9</b> Normality Assumption</a>
<ul>
<li class="chapter" data-level="9.1" data-path="normality-assumption.html"><a href="normality-assumption.html#introduction-3"><i class="fa fa-check"></i><b>9.1</b> Introduction</a></li>
<li class="chapter" data-level="9.2" data-path="normality-assumption.html"><a href="normality-assumption.html#maximum-likelihood-estimation"><i class="fa fa-check"></i><b>9.2</b> Maximum Likelihood Estimation</a>
<ul>
<li class="chapter" data-level="9.2.1" data-path="normality-assumption.html"><a href="normality-assumption.html#decomposition-of-the-quadratic-form"><i class="fa fa-check"></i><b>9.2.1</b> Decomposition of the Quadratic Form</a></li>
<li class="chapter" data-level="9.2.2" data-path="normality-assumption.html"><a href="normality-assumption.html#estimation-of-sigma2"><i class="fa fa-check"></i><b>9.2.2</b> Estimation of <span class="math inline">\(\sigma^2\)</span></a></li>
<li class="chapter" data-level="9.2.3" data-path="normality-assumption.html"><a href="normality-assumption.html#remarks-on-bias-and-practical-use"><i class="fa fa-check"></i><b>9.2.3</b> Remarks on Bias and Practical Use</a></li>
</ul></li>
<li class="chapter" data-level="9.3" data-path="normality-assumption.html"><a href="normality-assumption.html#distribution-of-the-estimates"><i class="fa fa-check"></i><b>9.3</b> Distribution of the Estimates</a>
<ul>
<li class="chapter" data-level="9.3.1" data-path="normality-assumption.html"><a href="normality-assumption.html#distribution-of-hatboldsymbolbeta-hatmathbfy-and-hatmathbfe"><i class="fa fa-check"></i><b>9.3.1</b> Distribution of <span class="math inline">\(\hat{\boldsymbol{\beta}}\)</span>, <span class="math inline">\(\hat{\mathbf{y}}\)</span>, and <span class="math inline">\(\hat{\mathbf{e}}\)</span></a></li>
<li class="chapter" data-level="9.3.2" data-path="normality-assumption.html"><a href="normality-assumption.html#distribution-of-hatsigma2"><i class="fa fa-check"></i><b>9.3.2</b> Distribution of <span class="math inline">\(\hat{\sigma}^2\)</span></a></li>
<li class="chapter" data-level="9.3.3" data-path="normality-assumption.html"><a href="normality-assumption.html#independence-of-hatmathbfe-and-hatmathbfy"><i class="fa fa-check"></i><b>9.3.3</b> Independence of <span class="math inline">\(\hat{\mathbf{e}}\)</span> and <span class="math inline">\(\hat{\mathbf{y}}\)</span></a></li>
</ul></li>
<li class="chapter" data-level="9.4" data-path="normality-assumption.html"><a href="normality-assumption.html#interval-estimation-1"><i class="fa fa-check"></i><b>9.4</b> Interval Estimation</a>
<ul>
<li class="chapter" data-level="9.4.1" data-path="normality-assumption.html"><a href="normality-assumption.html#confidence-intervals-for-the-coefficients"><i class="fa fa-check"></i><b>9.4.1</b> Confidence Intervals for the Coefficients</a></li>
<li class="chapter" data-level="9.4.2" data-path="normality-assumption.html"><a href="normality-assumption.html#confidence-intervals-for-the-expected-mean-of-a-new-observation-mathbfx_new"><i class="fa fa-check"></i><b>9.4.2</b> Confidence Intervals for the Expected Mean of a New Observation <span class="math inline">\(\mathbf{x}_{new}\)</span></a></li>
<li class="chapter" data-level="9.4.3" data-path="normality-assumption.html"><a href="normality-assumption.html#confidence-intervals-for-linear-combinations-of-boldsymbolbeta"><i class="fa fa-check"></i><b>9.4.3</b> Confidence Intervals for Linear Combinations of <span class="math inline">\(\boldsymbol{\beta}\)</span></a></li>
</ul></li>
<li class="chapter" data-level="9.5" data-path="normality-assumption.html"><a href="normality-assumption.html#hypothesis-testing"><i class="fa fa-check"></i><b>9.5</b> Hypothesis Testing</a>
<ul>
<li class="chapter" data-level="9.5.1" data-path="normality-assumption.html"><a href="normality-assumption.html#testing-for-the-overall-regression"><i class="fa fa-check"></i><b>9.5.1</b> Testing for the Overall Regression</a></li>
<li class="chapter" data-level="9.5.2" data-path="normality-assumption.html"><a href="normality-assumption.html#testing-if-one-variable-is-not-relevant"><i class="fa fa-check"></i><b>9.5.2</b> Testing if one variable is not relevant</a></li>
<li class="chapter" data-level="9.5.3" data-path="normality-assumption.html"><a href="normality-assumption.html#testing-if-a-subgroup-of-the-variables-is-relevant"><i class="fa fa-check"></i><b>9.5.3</b> Testing if a Subgroup of the Variables is Relevant</a></li>
</ul></li>
</ul></li>
</ul>

      </nav>
    </div>

    <div class="book-body">
      <div class="body-inner">
        <div class="book-header" role="navigation">
          <h1>
            <i class="fa fa-circle-o-notch fa-spin"></i><a href="./"></a>
          </h1>
        </div>

        <div class="page-wrapper" tabindex="-1" role="main">
          <div class="page-inner">

            <section class="normal" id="section-">
<div id="bootstrapping" class="section level1 hasAnchor" number="7">
<h1><span class="header-section-number">7</span> Bootstrapping<a href="bootstrapping.html#bootstrapping" class="anchor-section" aria-label="Anchor link to header"></a></h1>
<div id="introduction-2" class="section level2 hasAnchor" number="7.1">
<h2><span class="header-section-number">7.1</span> Introduction<a href="bootstrapping.html#introduction-2" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<p><strong>Bootstrapping</strong> is a resampling-based statistical method used to estimate the variability of a statistic by repeatedly sampling from the observed data <strong>with replacement</strong>.
Each resample, called a <em>bootstrap sample</em>, mimics the process of drawing new data from the population. By computing the statistic of interest (for example, the mean, median, or regression coefficients) for many bootstrap samples, we obtain an <strong>empirical distribution</strong> that approximates the sampling distribution of that statistic.</p>
<p>Unlike classical inference methods that rely on strong distributional assumptions (such as normality), bootstrapping is <strong>non-parametric</strong> and <strong>data-driven</strong>, making it highly flexible and particularly useful when sample sizes are small or assumptions are difficult to justify.</p>
<p>In a way, bootstrapping can be viewed as the <em>“poor man’s probability”</em>—it lets us approximate uncertainty purely from data, without relying on analytical formulas.</p>
<div id="key-points-6" class="section level3 hasAnchor" number="7.1.1">
<h3><span class="header-section-number">7.1.1</span> Key Points<a href="bootstrapping.html#key-points-6" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<ol style="list-style-type: decimal">
<li><strong>Resampling with Replacement:</strong> Each bootstrap sample is created by randomly drawing observations from the original dataset, allowing repetitions.</li>
<li><strong>No Distributional Assumptions:</strong> Bootstrapping makes no assumptions about the underlying population distribution.</li>
<li><strong>Estimation of Uncertainty:</strong> It provides estimates of standard errors, confidence intervals, and other measures of variability directly from the data.</li>
</ol>
<p>In short, bootstrapping provides a simple and powerful way to quantify uncertainty when theoretical solutions are unavailable or unreliable.</p>
<hr />
</div>
</div>
<div id="bootstrapping-example" class="section level2 hasAnchor" number="7.2">
<h2><span class="header-section-number">7.2</span> Bootstrapping Example<a href="bootstrapping.html#bootstrapping-example" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<p>Up to this point, we have computed several regression-related quantities of interest:</p>
<p><span class="math display">\[ \hat{\boldsymbol{\beta}}, \quad \hat{\mathbf{y}}, \quad \hat{\mathbf{e}} \]</span></p>
<p>These are all <em>point estimates</em> obtained from the least squares fit.
When we studied influential observations and outliers, we saw how removing certain data points affected these estimates — but those changes provided only limited information about uncertainty.</p>
<p>Bootstrapping allows us to go much further. By repeatedly resampling the data and refitting the model, we can build empirical distributions for our estimates and thus quantify their variability.</p>
<p>Let’s illustrate this using GDP data.</p>
<hr />
<div class="sourceCode" id="cb148"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb148-1"><a href="bootstrapping.html#cb148-1" tabindex="-1"></a><span class="co"># Data Load</span></span>
<span id="cb148-2"><a href="bootstrapping.html#cb148-2" tabindex="-1"></a>dat <span class="ot">&lt;-</span> <span class="fu">read.csv</span>(<span class="at">file =</span> <span class="st">&quot;Gdp data.csv&quot;</span>)</span>
<span id="cb148-3"><a href="bootstrapping.html#cb148-3" tabindex="-1"></a></span>
<span id="cb148-4"><a href="bootstrapping.html#cb148-4" tabindex="-1"></a><span class="co"># Assigns Values</span></span>
<span id="cb148-5"><a href="bootstrapping.html#cb148-5" tabindex="-1"></a>X <span class="ot">&lt;-</span> <span class="fu">as.matrix</span>(dat[, <span class="dv">2</span><span class="sc">:</span><span class="dv">6</span>])</span>
<span id="cb148-6"><a href="bootstrapping.html#cb148-6" tabindex="-1"></a>y <span class="ot">&lt;-</span> <span class="fu">as.numeric</span>(dat<span class="sc">$</span>gdp)</span>
<span id="cb148-7"><a href="bootstrapping.html#cb148-7" tabindex="-1"></a></span>
<span id="cb148-8"><a href="bootstrapping.html#cb148-8" tabindex="-1"></a><span class="co"># Regression without Bootstrapping</span></span>
<span id="cb148-9"><a href="bootstrapping.html#cb148-9" tabindex="-1"></a>norReg <span class="ot">&lt;-</span> <span class="fu">lm</span>(y <span class="sc">~</span> X)</span>
<span id="cb148-10"><a href="bootstrapping.html#cb148-10" tabindex="-1"></a></span>
<span id="cb148-11"><a href="bootstrapping.html#cb148-11" tabindex="-1"></a><span class="co"># Number of Observations</span></span>
<span id="cb148-12"><a href="bootstrapping.html#cb148-12" tabindex="-1"></a>n <span class="ot">&lt;-</span> <span class="fu">nrow</span>(X)</span>
<span id="cb148-13"><a href="bootstrapping.html#cb148-13" tabindex="-1"></a></span>
<span id="cb148-14"><a href="bootstrapping.html#cb148-14" tabindex="-1"></a><span class="co"># Design Matrix</span></span>
<span id="cb148-15"><a href="bootstrapping.html#cb148-15" tabindex="-1"></a>X <span class="ot">&lt;-</span> <span class="fu">cbind</span>(<span class="fu">rep</span>(<span class="dv">1</span>, n), X)</span>
<span id="cb148-16"><a href="bootstrapping.html#cb148-16" tabindex="-1"></a></span>
<span id="cb148-17"><a href="bootstrapping.html#cb148-17" tabindex="-1"></a><span class="co"># Number of Variables</span></span>
<span id="cb148-18"><a href="bootstrapping.html#cb148-18" tabindex="-1"></a>p <span class="ot">&lt;-</span> <span class="fu">ncol</span>(X)</span>
<span id="cb148-19"><a href="bootstrapping.html#cb148-19" tabindex="-1"></a></span>
<span id="cb148-20"><a href="bootstrapping.html#cb148-20" tabindex="-1"></a><span class="co"># Number of Bootstrapping Samples</span></span>
<span id="cb148-21"><a href="bootstrapping.html#cb148-21" tabindex="-1"></a>m <span class="ot">&lt;-</span> <span class="dv">1000</span></span>
<span id="cb148-22"><a href="bootstrapping.html#cb148-22" tabindex="-1"></a></span>
<span id="cb148-23"><a href="bootstrapping.html#cb148-23" tabindex="-1"></a><span class="co"># Bootstrapping Coefficient Estimates</span></span>
<span id="cb148-24"><a href="bootstrapping.html#cb148-24" tabindex="-1"></a>booCoe <span class="ot">&lt;-</span> <span class="fu">matrix</span>(<span class="at">data =</span> <span class="cn">NA</span>, <span class="at">nrow =</span> m, <span class="at">ncol =</span> p)</span>
<span id="cb148-25"><a href="bootstrapping.html#cb148-25" tabindex="-1"></a><span class="cf">for</span>(i <span class="cf">in</span> <span class="dv">1</span><span class="sc">:</span>m){</span>
<span id="cb148-26"><a href="bootstrapping.html#cb148-26" tabindex="-1"></a>  <span class="co"># Sample Selection</span></span>
<span id="cb148-27"><a href="bootstrapping.html#cb148-27" tabindex="-1"></a>  booSel <span class="ot">&lt;-</span> <span class="fu">sample</span>(<span class="at">x =</span> <span class="dv">1</span><span class="sc">:</span>n, <span class="at">size =</span> n, <span class="at">replace =</span> <span class="cn">TRUE</span>)</span>
<span id="cb148-28"><a href="bootstrapping.html#cb148-28" tabindex="-1"></a>  <span class="co"># Bootstrap Samples</span></span>
<span id="cb148-29"><a href="bootstrapping.html#cb148-29" tabindex="-1"></a>  Xb <span class="ot">&lt;-</span> X[booSel, ]</span>
<span id="cb148-30"><a href="bootstrapping.html#cb148-30" tabindex="-1"></a>  yb <span class="ot">&lt;-</span> y[booSel]</span>
<span id="cb148-31"><a href="bootstrapping.html#cb148-31" tabindex="-1"></a>  <span class="co"># Coefficient Estimation</span></span>
<span id="cb148-32"><a href="bootstrapping.html#cb148-32" tabindex="-1"></a>  booCoe[i, ] <span class="ot">&lt;-</span> <span class="fu">solve</span>(<span class="fu">t</span>(Xb) <span class="sc">%*%</span> Xb, <span class="fu">t</span>(Xb) <span class="sc">%*%</span> yb)</span>
<span id="cb148-33"><a href="bootstrapping.html#cb148-33" tabindex="-1"></a>}</span>
<span id="cb148-34"><a href="bootstrapping.html#cb148-34" tabindex="-1"></a></span>
<span id="cb148-35"><a href="bootstrapping.html#cb148-35" tabindex="-1"></a><span class="co"># Plots the distribution for each coefficient with the point estimate without suing bootstrapping</span></span>
<span id="cb148-36"><a href="bootstrapping.html#cb148-36" tabindex="-1"></a><span class="fu">boxplot</span>(booCoe,</span>
<span id="cb148-37"><a href="bootstrapping.html#cb148-37" tabindex="-1"></a>        <span class="at">col =</span> <span class="fu">rgb</span>(<span class="dv">0</span>, <span class="dv">0</span>, <span class="dv">1</span>, <span class="fl">0.5</span>),</span>
<span id="cb148-38"><a href="bootstrapping.html#cb148-38" tabindex="-1"></a>        <span class="at">xaxt =</span> <span class="st">&quot;n&quot;</span>)</span>
<span id="cb148-39"><a href="bootstrapping.html#cb148-39" tabindex="-1"></a><span class="fu">axis</span>(<span class="at">side =</span> <span class="dv">1</span>, <span class="at">at =</span> <span class="dv">1</span><span class="sc">:</span><span class="dv">6</span>, <span class="at">labels =</span> <span class="fu">c</span>(<span class="st">&quot;Intercept&quot;</span>, <span class="st">&quot;Inf&quot;</span>, <span class="st">&quot;Une&quot;</span>, <span class="st">&quot;Int&quot;</span>, <span class="st">&quot;Gov&quot;</span>, <span class="st">&quot;Exp&quot;</span>))</span>
<span id="cb148-40"><a href="bootstrapping.html#cb148-40" tabindex="-1"></a><span class="fu">abline</span>(<span class="at">h   =</span> <span class="dv">0</span>,</span>
<span id="cb148-41"><a href="bootstrapping.html#cb148-41" tabindex="-1"></a>       <span class="at">col =</span> <span class="fu">rgb</span>(<span class="dv">1</span>, <span class="dv">0</span>, <span class="dv">0</span>),</span>
<span id="cb148-42"><a href="bootstrapping.html#cb148-42" tabindex="-1"></a>       <span class="at">lwd =</span> <span class="dv">2</span>)</span>
<span id="cb148-43"><a href="bootstrapping.html#cb148-43" tabindex="-1"></a><span class="fu">points</span>(norReg<span class="sc">$</span>coefficients, <span class="at">pch =</span> <span class="dv">17</span>, <span class="at">col =</span> <span class="fu">rgb</span>(<span class="dv">0</span>,<span class="dv">1</span>,<span class="dv">0</span>))</span></code></pre></div>
<p><img src="_main_files/figure-html/bootstrapping-coefficients-1.png" width="672" /></p>
<div class="sourceCode" id="cb149"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb149-1"><a href="bootstrapping.html#cb149-1" tabindex="-1"></a><span class="co"># Compare to the Summary of the regression without Bootstrapping</span></span>
<span id="cb149-2"><a href="bootstrapping.html#cb149-2" tabindex="-1"></a><span class="fu">summary</span>(norReg)</span></code></pre></div>
<pre><code>## 
## Call:
## lm(formula = y ~ X)
## 
## Residuals:
##      Min       1Q   Median       3Q      Max 
## -1.56610 -0.38300 -0.00634  0.36630  1.22542 
## 
## Coefficients:
##              Estimate Std. Error t value Pr(&gt;|t|)    
## (Intercept)  1.555301   0.380440   4.088 6.41e-05 ***
## Xinf         0.312218   0.090012   3.469 0.000647 ***
## Xune        -0.377334   0.129275  -2.919 0.003938 ** 
## Xint         0.177827   0.128312   1.386 0.167403    
## Xgov        -0.008483   0.010361  -0.819 0.413950    
## Xexp         0.064657   0.011930   5.420 1.80e-07 ***
## ---
## Signif. codes:  0 &#39;***&#39; 0.001 &#39;**&#39; 0.01 &#39;*&#39; 0.05 &#39;.&#39; 0.1 &#39; &#39; 1
## 
## Residual standard error: 0.5024 on 190 degrees of freedom
## Multiple R-squared:  0.8096, Adjusted R-squared:  0.8046 
## F-statistic: 161.6 on 5 and 190 DF,  p-value: &lt; 2.2e-16</code></pre>
<details>
<summary>
<span style="color:green">Explanation of the Code</span>
</summary>
<p>This code performs <strong>bootstrap resampling</strong> of a linear regression model using GDP data.</p>
<ol style="list-style-type: decimal">
<li><p>The dataset is read and split into the predictor matrix <code>X</code> and the response vector <code>y</code>.</p></li>
<li><p>A standard linear model (<code>norReg</code>) is fit to the original data for reference.</p></li>
<li><p>A design matrix is constructed by adding an intercept term.</p></li>
<li><p>We specify <code>m = 1000</code>, meaning 1000 bootstrap replications.</p></li>
<li><p>For each replication:</p>
<ul>
<li>A bootstrap sample is drawn from the indices <code>1:n</code> with replacement.</li>
<li>The model is refit using this resampled data.</li>
<li>The estimated coefficients are stored in the matrix <code>booCoe</code>.</li>
</ul></li>
<li><p>Finally, a <strong>boxplot</strong> displays the bootstrap distributions of the coefficients, with:</p>
<ul>
<li>The <strong>red line</strong> indicating zero,</li>
<li>The <strong>green triangles</strong> marking the original least squares estimates.</li>
</ul></li>
</ol>
<p>This visualization highlights the <strong>variability</strong> of each coefficient estimate.</p>
</details>
<p>The plot shows that the <strong>intercept</strong> has substantial uncertainty, while coefficients for inflation, unemployment, and interest rates show moderate variability.
Government expenditure and exports have very little variability.</p>
<p>Even though the intercept varies widely, it remains positive in all bootstrap samples. Inflation and unemployment coefficients almost never change sign, suggesting strong evidence for their direction of effect. The interest rate coefficient is usually positive but sometimes negative, suggesting little evidence for the direction of the effect. The government expenditure coefficient hovers near zero. Exports remain small but consistently positive.</p>
<p>Notice this relationships and the number of <code>*</code> in the summary of the regular linear regression. Whenever a coefficient has all (or almost all) of its observations on one side of the red line, the summary assigns more <code>*</code>, while when a coefficient that has several observations on either side of the line, has no <code>*</code> indicating little significance.</p>
<hr />
<p>We can also explore how the estimated coefficients relate to each other.</p>
<div class="sourceCode" id="cb151"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb151-1"><a href="bootstrapping.html#cb151-1" tabindex="-1"></a><span class="co"># Data Frame</span></span>
<span id="cb151-2"><a href="bootstrapping.html#cb151-2" tabindex="-1"></a>booCoeDf <span class="ot">&lt;-</span> <span class="fu">data.frame</span>(booCoe)</span>
<span id="cb151-3"><a href="bootstrapping.html#cb151-3" tabindex="-1"></a><span class="fu">colnames</span>(booCoeDf) <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="st">&quot;Intercept&quot;</span>, <span class="st">&quot;Inf&quot;</span>, <span class="st">&quot;Une&quot;</span>, <span class="st">&quot;Int&quot;</span>, <span class="st">&quot;Gov&quot;</span>, <span class="st">&quot;Exp&quot;</span>)</span>
<span id="cb151-4"><a href="bootstrapping.html#cb151-4" tabindex="-1"></a><span class="fu">pairs</span>(booCoeDf)</span></code></pre></div>
<p><img src="_main_files/figure-html/bootstraping-coefficients-correlation-1.png" width="672" /></p>
<details>
<summary>
<span style="color:green">Explanation of the Code</span>
</summary>
<p>This code creates a <strong>pairwise scatterplot matrix</strong> (<code>pairs</code>) of the bootstrap coefficient estimates. Each panel shows the relationship between two coefficients across all bootstrap samples.</p>
</details>
<p>The plot reveals that coefficients for <strong>inflation</strong>, <strong>unemployment</strong>, and <strong>interest rate</strong> are strongly correlated, indicating possible multicollinearity among these predictors.
In contrast, <strong>government expenditure</strong> and <strong>exports</strong> appear largely independent of the others.</p>
<hr />
<div id="bootstrapping-predictions" class="section level3 hasAnchor" number="7.2.1">
<h3><span class="header-section-number">7.2.1</span> Bootstrapping Predictions<a href="bootstrapping.html#bootstrapping-predictions" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<p>Bootstrapping can be applied not only to model coefficients but also to <strong>predicted values</strong>.
We can use bootstrap samples to construct <strong>confidence intervals</strong> for the mean predictions and <strong>prediction intervals</strong> for individual outcomes.</p>
<div class="sourceCode" id="cb152"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb152-1"><a href="bootstrapping.html#cb152-1" tabindex="-1"></a><span class="co"># Mean Estimates</span></span>
<span id="cb152-2"><a href="bootstrapping.html#cb152-2" tabindex="-1"></a>yh <span class="ot">&lt;-</span> booCoe <span class="sc">%*%</span> <span class="fu">t</span>(X)</span>
<span id="cb152-3"><a href="bootstrapping.html#cb152-3" tabindex="-1"></a></span>
<span id="cb152-4"><a href="bootstrapping.html#cb152-4" tabindex="-1"></a><span class="co"># Bootstrap Prediction Quantiles 2.5% and 97.5%</span></span>
<span id="cb152-5"><a href="bootstrapping.html#cb152-5" tabindex="-1"></a>booConQua <span class="ot">&lt;-</span> <span class="fu">apply</span>(<span class="at">X =</span> yh, <span class="at">MARGIN =</span> <span class="dv">2</span>, <span class="at">FUN =</span> quantile, <span class="at">probs =</span> <span class="fu">c</span>(<span class="fl">0.025</span>, <span class="fl">0.975</span>))</span>
<span id="cb152-6"><a href="bootstrapping.html#cb152-6" tabindex="-1"></a></span>
<span id="cb152-7"><a href="bootstrapping.html#cb152-7" tabindex="-1"></a><span class="co"># Plots the Intervals and Observations</span></span>
<span id="cb152-8"><a href="bootstrapping.html#cb152-8" tabindex="-1"></a><span class="co"># Number of Plots</span></span>
<span id="cb152-9"><a href="bootstrapping.html#cb152-9" tabindex="-1"></a>numPlo <span class="ot">&lt;-</span> <span class="dv">2</span></span>
<span id="cb152-10"><a href="bootstrapping.html#cb152-10" tabindex="-1"></a>ymin <span class="ot">&lt;-</span> <span class="fu">min</span>(y, booConQua)</span>
<span id="cb152-11"><a href="bootstrapping.html#cb152-11" tabindex="-1"></a>ymax <span class="ot">&lt;-</span> <span class="fu">max</span>(y, booConQua)</span>
<span id="cb152-12"><a href="bootstrapping.html#cb152-12" tabindex="-1"></a>xmin <span class="ot">&lt;-</span> <span class="dv">0</span></span>
<span id="cb152-13"><a href="bootstrapping.html#cb152-13" tabindex="-1"></a>xmax <span class="ot">&lt;-</span> n <span class="sc">/</span> numPlo</span>
<span id="cb152-14"><a href="bootstrapping.html#cb152-14" tabindex="-1"></a>xSet <span class="ot">&lt;-</span> <span class="fu">matrix</span>(<span class="at">data =</span> <span class="dv">1</span><span class="sc">:</span>n, <span class="at">nrow =</span> numPlo, <span class="at">ncol =</span> n <span class="sc">/</span> numPlo)</span>
<span id="cb152-15"><a href="bootstrapping.html#cb152-15" tabindex="-1"></a></span>
<span id="cb152-16"><a href="bootstrapping.html#cb152-16" tabindex="-1"></a><span class="co"># Bootstrap Confidence Intervals Plot</span></span>
<span id="cb152-17"><a href="bootstrapping.html#cb152-17" tabindex="-1"></a><span class="fu">par</span>(<span class="at">mfrow =</span> <span class="fu">c</span>(numPlo, <span class="dv">1</span>))</span>
<span id="cb152-18"><a href="bootstrapping.html#cb152-18" tabindex="-1"></a><span class="fu">par</span>(<span class="at">mar =</span> <span class="fu">c</span>(<span class="dv">0</span>, <span class="dv">3</span>, <span class="dv">0</span>, <span class="dv">0</span>))</span>
<span id="cb152-19"><a href="bootstrapping.html#cb152-19" tabindex="-1"></a><span class="cf">for</span>(i <span class="cf">in</span> <span class="dv">1</span><span class="sc">:</span>numPlo){</span>
<span id="cb152-20"><a href="bootstrapping.html#cb152-20" tabindex="-1"></a>  <span class="fu">plot</span>(<span class="cn">NULL</span>,</span>
<span id="cb152-21"><a href="bootstrapping.html#cb152-21" tabindex="-1"></a>       <span class="at">xlim =</span> <span class="fu">c</span>(xmin, xmax),</span>
<span id="cb152-22"><a href="bootstrapping.html#cb152-22" tabindex="-1"></a>       <span class="at">ylim =</span> <span class="fu">c</span>(ymin, ymax),</span>
<span id="cb152-23"><a href="bootstrapping.html#cb152-23" tabindex="-1"></a>       <span class="at">ylab =</span> <span class="st">&quot;GDP % Growth&quot;</span>,</span>
<span id="cb152-24"><a href="bootstrapping.html#cb152-24" tabindex="-1"></a>       <span class="at">xlab =</span> <span class="st">&quot;Countries&quot;</span>,</span>
<span id="cb152-25"><a href="bootstrapping.html#cb152-25" tabindex="-1"></a>       <span class="at">xaxt =</span> <span class="st">&quot;n&quot;</span>)</span>
<span id="cb152-26"><a href="bootstrapping.html#cb152-26" tabindex="-1"></a>  <span class="fu">segments</span>(<span class="at">x0  =</span> xSet[i, ],</span>
<span id="cb152-27"><a href="bootstrapping.html#cb152-27" tabindex="-1"></a>           <span class="at">x1  =</span> xSet[i, ],</span>
<span id="cb152-28"><a href="bootstrapping.html#cb152-28" tabindex="-1"></a>           <span class="at">y0  =</span> booConQua[<span class="dv">1</span>, xSet[i, ]],</span>
<span id="cb152-29"><a href="bootstrapping.html#cb152-29" tabindex="-1"></a>           <span class="at">y1  =</span> booConQua[<span class="dv">2</span>, xSet[i, ]],</span>
<span id="cb152-30"><a href="bootstrapping.html#cb152-30" tabindex="-1"></a>           <span class="at">lwd =</span> <span class="dv">3</span>)</span>
<span id="cb152-31"><a href="bootstrapping.html#cb152-31" tabindex="-1"></a>  <span class="fu">points</span>(<span class="at">x   =</span> xSet[i, ],</span>
<span id="cb152-32"><a href="bootstrapping.html#cb152-32" tabindex="-1"></a>         <span class="at">y   =</span> y[xSet[i, ]],</span>
<span id="cb152-33"><a href="bootstrapping.html#cb152-33" tabindex="-1"></a>         <span class="at">pch =</span> <span class="dv">16</span>,</span>
<span id="cb152-34"><a href="bootstrapping.html#cb152-34" tabindex="-1"></a>         <span class="at">col =</span> <span class="fu">rgb</span>(<span class="dv">0</span>, <span class="dv">0</span>, <span class="dv">1</span>, <span class="fl">0.75</span>))</span>
<span id="cb152-35"><a href="bootstrapping.html#cb152-35" tabindex="-1"></a>}</span></code></pre></div>
<p><img src="_main_files/figure-html/bootstrap-in-sample-mean-predictions-1.png" width="672" /></p>
<div class="sourceCode" id="cb153"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb153-1"><a href="bootstrapping.html#cb153-1" tabindex="-1"></a><span class="co"># Coverage of the Bootstrap Confidence Intervals</span></span>
<span id="cb153-2"><a href="bootstrapping.html#cb153-2" tabindex="-1"></a><span class="fu">print</span>(<span class="fu">paste0</span>(<span class="st">&quot;Bootstrap Confidence Intervals Coverage = &quot;</span>, <span class="fu">round</span>(<span class="fu">mean</span>((y <span class="sc">&gt;</span> booConQua[<span class="dv">1</span>, ]) <span class="sc">&amp;</span> (y <span class="sc">&lt;</span> booConQua[<span class="dv">2</span>, ])) <span class="sc">*</span> <span class="dv">100</span>, <span class="dv">2</span>) ))</span></code></pre></div>
<pre><code>## [1] &quot;Bootstrap Confidence Intervals Coverage = 28.06&quot;</code></pre>
<details>
<summary>
<span style="color:green">Explanation of the Code</span>
</summary>
<p>Here, the matrix multiplication <code>booCoe %*% t(X)</code> computes the fitted values for all bootstrap replications.
For each observation, the 2.5% and 97.5% quantiles across these replications form a <strong>95% confidence interval</strong> for the mean prediction.</p>
<p>The resulting plot displays:</p>
<ul>
<li><strong>Thick vertical lines</strong> for confidence intervals,</li>
<li><strong>Blue dots</strong> for observed GDP values.</li>
</ul>
<p>Finally, the coverage rate — the proportion of true observations lying within their confidence intervals — is printed.</p>
</details>
<p>The intervals for mean predictions do not cover 95% of the observed values.
This is expected, because these intervals quantify uncertainty in the <em>mean response</em>, not in individual observations. They do not account for the variability due to random errors.</p>
<hr />
</div>
<div id="adding-prediction-intervals" class="section level3 hasAnchor" number="7.2.2">
<h3><span class="header-section-number">7.2.2</span> Adding Prediction Intervals<a href="bootstrapping.html#adding-prediction-intervals" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<p>To include the effect of random errors, we can also bootstrap the residuals and use them to construct <strong>prediction intervals</strong>.</p>
<div class="sourceCode" id="cb155"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb155-1"><a href="bootstrapping.html#cb155-1" tabindex="-1"></a><span class="do">### Error Bootstrapping Samples</span></span>
<span id="cb155-2"><a href="bootstrapping.html#cb155-2" tabindex="-1"></a>eh <span class="ot">&lt;-</span> <span class="fu">t</span>(<span class="fu">t</span>(yh) <span class="sc">-</span> y)</span>
<span id="cb155-3"><a href="bootstrapping.html#cb155-3" tabindex="-1"></a></span>
<span id="cb155-4"><a href="bootstrapping.html#cb155-4" tabindex="-1"></a><span class="do">### Then we re-sample the errors</span></span>
<span id="cb155-5"><a href="bootstrapping.html#cb155-5" tabindex="-1"></a>eh <span class="ot">&lt;-</span> eh[<span class="fu">sample</span>(<span class="at">x =</span> <span class="dv">1</span><span class="sc">:</span>(m <span class="sc">*</span> n), <span class="at">size =</span> m <span class="sc">*</span> n, <span class="at">replace =</span> <span class="cn">FALSE</span>)]</span>
<span id="cb155-6"><a href="bootstrapping.html#cb155-6" tabindex="-1"></a></span>
<span id="cb155-7"><a href="bootstrapping.html#cb155-7" tabindex="-1"></a><span class="co"># Adds the resampled errors to the bootstrap observations sample</span></span>
<span id="cb155-8"><a href="bootstrapping.html#cb155-8" tabindex="-1"></a>yp <span class="ot">&lt;-</span> yh <span class="sc">+</span> eh</span>
<span id="cb155-9"><a href="bootstrapping.html#cb155-9" tabindex="-1"></a></span>
<span id="cb155-10"><a href="bootstrapping.html#cb155-10" tabindex="-1"></a><span class="co"># Bootstrap Prediction Quantiles 2.5% and 97.5%</span></span>
<span id="cb155-11"><a href="bootstrapping.html#cb155-11" tabindex="-1"></a>booPreQua <span class="ot">&lt;-</span> <span class="fu">apply</span>(<span class="at">X =</span> yp, <span class="at">MARGIN =</span> <span class="dv">2</span>, <span class="at">FUN =</span> quantile, <span class="at">probs =</span> <span class="fu">c</span>(<span class="fl">0.025</span>, <span class="fl">0.975</span>))</span>
<span id="cb155-12"><a href="bootstrapping.html#cb155-12" tabindex="-1"></a></span>
<span id="cb155-13"><a href="bootstrapping.html#cb155-13" tabindex="-1"></a><span class="co"># Plots the Intervals and Observations</span></span>
<span id="cb155-14"><a href="bootstrapping.html#cb155-14" tabindex="-1"></a><span class="co"># Number of Plots</span></span>
<span id="cb155-15"><a href="bootstrapping.html#cb155-15" tabindex="-1"></a>numPlo <span class="ot">&lt;-</span> <span class="dv">2</span></span>
<span id="cb155-16"><a href="bootstrapping.html#cb155-16" tabindex="-1"></a>ymin <span class="ot">&lt;-</span> <span class="fu">min</span>(y, booPreQua)</span>
<span id="cb155-17"><a href="bootstrapping.html#cb155-17" tabindex="-1"></a>ymax <span class="ot">&lt;-</span> <span class="fu">max</span>(y, booPreQua)</span>
<span id="cb155-18"><a href="bootstrapping.html#cb155-18" tabindex="-1"></a>xmin <span class="ot">&lt;-</span> <span class="dv">0</span></span>
<span id="cb155-19"><a href="bootstrapping.html#cb155-19" tabindex="-1"></a>xmax <span class="ot">&lt;-</span> n <span class="sc">/</span> numPlo</span>
<span id="cb155-20"><a href="bootstrapping.html#cb155-20" tabindex="-1"></a>xSet <span class="ot">&lt;-</span> <span class="fu">matrix</span>(<span class="at">data =</span> <span class="dv">1</span><span class="sc">:</span>n, <span class="at">nrow =</span> numPlo, <span class="at">ncol =</span> n <span class="sc">/</span> numPlo)</span>
<span id="cb155-21"><a href="bootstrapping.html#cb155-21" tabindex="-1"></a></span>
<span id="cb155-22"><a href="bootstrapping.html#cb155-22" tabindex="-1"></a><span class="co"># Non-Covered Observations</span></span>
<span id="cb155-23"><a href="bootstrapping.html#cb155-23" tabindex="-1"></a>nonCov <span class="ot">&lt;-</span> ((y <span class="sc">&gt;</span> booPreQua[<span class="dv">1</span>, ]) <span class="sc">&amp;</span> (y <span class="sc">&lt;</span> booPreQua[<span class="dv">2</span>, ]))</span>
<span id="cb155-24"><a href="bootstrapping.html#cb155-24" tabindex="-1"></a></span>
<span id="cb155-25"><a href="bootstrapping.html#cb155-25" tabindex="-1"></a><span class="co"># Bootstrap Confidence Intervals Plot</span></span>
<span id="cb155-26"><a href="bootstrapping.html#cb155-26" tabindex="-1"></a><span class="fu">par</span>(<span class="at">mfrow =</span> <span class="fu">c</span>(numPlo, <span class="dv">1</span>))</span>
<span id="cb155-27"><a href="bootstrapping.html#cb155-27" tabindex="-1"></a><span class="fu">par</span>(<span class="at">mar =</span> <span class="fu">c</span>(<span class="dv">0</span>, <span class="dv">3</span>, <span class="dv">0</span>, <span class="dv">0</span>))</span>
<span id="cb155-28"><a href="bootstrapping.html#cb155-28" tabindex="-1"></a><span class="cf">for</span>(i <span class="cf">in</span> <span class="dv">1</span><span class="sc">:</span>numPlo){</span>
<span id="cb155-29"><a href="bootstrapping.html#cb155-29" tabindex="-1"></a>  <span class="fu">plot</span>(<span class="cn">NULL</span>,</span>
<span id="cb155-30"><a href="bootstrapping.html#cb155-30" tabindex="-1"></a>       <span class="at">xlim =</span> <span class="fu">c</span>(xmin, xmax),</span>
<span id="cb155-31"><a href="bootstrapping.html#cb155-31" tabindex="-1"></a>       <span class="at">ylim =</span> <span class="fu">c</span>(ymin, ymax),</span>
<span id="cb155-32"><a href="bootstrapping.html#cb155-32" tabindex="-1"></a>       <span class="at">ylab =</span> <span class="st">&quot;GDP % Growth&quot;</span>,</span>
<span id="cb155-33"><a href="bootstrapping.html#cb155-33" tabindex="-1"></a>       <span class="at">xlab =</span> <span class="st">&quot;Countries&quot;</span>,</span>
<span id="cb155-34"><a href="bootstrapping.html#cb155-34" tabindex="-1"></a>       <span class="at">xaxt =</span> <span class="st">&quot;n&quot;</span>)</span>
<span id="cb155-35"><a href="bootstrapping.html#cb155-35" tabindex="-1"></a>  <span class="fu">segments</span>(<span class="at">x0  =</span> xSet[i, ] <span class="sc">-</span> (i <span class="sc">-</span> <span class="dv">1</span>),</span>
<span id="cb155-36"><a href="bootstrapping.html#cb155-36" tabindex="-1"></a>           <span class="at">x1  =</span> xSet[i, ] <span class="sc">-</span> (i <span class="sc">-</span> <span class="dv">1</span>),</span>
<span id="cb155-37"><a href="bootstrapping.html#cb155-37" tabindex="-1"></a>           <span class="at">y0  =</span> booConQua[<span class="dv">1</span>, xSet[i, ]],</span>
<span id="cb155-38"><a href="bootstrapping.html#cb155-38" tabindex="-1"></a>           <span class="at">y1  =</span> booConQua[<span class="dv">2</span>, xSet[i, ]],</span>
<span id="cb155-39"><a href="bootstrapping.html#cb155-39" tabindex="-1"></a>           <span class="at">lwd =</span> <span class="dv">3</span>)</span>
<span id="cb155-40"><a href="bootstrapping.html#cb155-40" tabindex="-1"></a>  <span class="fu">segments</span>(<span class="at">x0  =</span> xSet[i, ] <span class="sc">-</span> (i <span class="sc">-</span> <span class="dv">1</span>),</span>
<span id="cb155-41"><a href="bootstrapping.html#cb155-41" tabindex="-1"></a>           <span class="at">x1  =</span> xSet[i, ] <span class="sc">-</span> (i <span class="sc">-</span> <span class="dv">1</span>),</span>
<span id="cb155-42"><a href="bootstrapping.html#cb155-42" tabindex="-1"></a>           <span class="at">y0  =</span> booPreQua[<span class="dv">1</span>, xSet[i, ]],</span>
<span id="cb155-43"><a href="bootstrapping.html#cb155-43" tabindex="-1"></a>           <span class="at">y1  =</span> booPreQua[<span class="dv">2</span>, xSet[i, ]],</span>
<span id="cb155-44"><a href="bootstrapping.html#cb155-44" tabindex="-1"></a>           <span class="at">lwd =</span> <span class="dv">1</span>)</span>
<span id="cb155-45"><a href="bootstrapping.html#cb155-45" tabindex="-1"></a>  <span class="fu">points</span>(<span class="at">x   =</span> xSet[i, ] <span class="sc">-</span> (i <span class="sc">-</span> <span class="dv">1</span>),</span>
<span id="cb155-46"><a href="bootstrapping.html#cb155-46" tabindex="-1"></a>         <span class="at">y   =</span> y[xSet[i, ]],</span>
<span id="cb155-47"><a href="bootstrapping.html#cb155-47" tabindex="-1"></a>         <span class="at">pch =</span> <span class="dv">16</span>,</span>
<span id="cb155-48"><a href="bootstrapping.html#cb155-48" tabindex="-1"></a>         <span class="at">col =</span> <span class="fu">rgb</span>(<span class="dv">0</span>, <span class="dv">1</span>, <span class="dv">0</span>, <span class="fl">0.75</span>))</span>
<span id="cb155-49"><a href="bootstrapping.html#cb155-49" tabindex="-1"></a>  <span class="fu">points</span>(<span class="at">x   =</span> xSet[i, ][<span class="sc">!</span>nonCov[xSet[i, ]]] <span class="sc">-</span> (i <span class="sc">-</span> <span class="dv">1</span>),</span>
<span id="cb155-50"><a href="bootstrapping.html#cb155-50" tabindex="-1"></a>         <span class="at">y   =</span> y[xSet[i, ][<span class="sc">!</span>nonCov[xSet[i, ]]]],</span>
<span id="cb155-51"><a href="bootstrapping.html#cb155-51" tabindex="-1"></a>         <span class="at">pch =</span> <span class="dv">16</span>,</span>
<span id="cb155-52"><a href="bootstrapping.html#cb155-52" tabindex="-1"></a>         <span class="at">col =</span> <span class="fu">rgb</span>(<span class="dv">1</span>, <span class="dv">0</span>, <span class="dv">0</span>, <span class="fl">0.75</span>))</span>
<span id="cb155-53"><a href="bootstrapping.html#cb155-53" tabindex="-1"></a>}</span></code></pre></div>
<p><img src="_main_files/figure-html/bootstrapping-prediction_intervales-1.png" width="672" /></p>
<div class="sourceCode" id="cb156"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb156-1"><a href="bootstrapping.html#cb156-1" tabindex="-1"></a><span class="co"># Coverage of the Bootstrap Confidence Intervals</span></span>
<span id="cb156-2"><a href="bootstrapping.html#cb156-2" tabindex="-1"></a><span class="fu">print</span>(<span class="fu">paste0</span>(<span class="st">&quot;Bootstrap Predictive Intervals Coverage = &quot;</span>, <span class="fu">round</span>(<span class="fu">mean</span>((y <span class="sc">&gt;</span> booPreQua[<span class="dv">1</span>, ]) <span class="sc">&amp;</span> (y <span class="sc">&lt;</span> booPreQua[<span class="dv">2</span>, ])) <span class="sc">*</span> <span class="dv">100</span>, <span class="dv">2</span>) ))</span></code></pre></div>
<pre><code>## [1] &quot;Bootstrap Predictive Intervals Coverage = 95.41&quot;</code></pre>
<details>
<summary>
<span style="color:green">Explanation of the Code</span>
</summary>
<ol style="list-style-type: decimal">
<li><p>Residuals (<code>eh</code>) are obtained by subtracting observed GDP from the bootstrap mean estimates.</p></li>
<li><p>These residuals are resampled and added to the fitted values to simulate new predictions (<code>yp</code>).</p></li>
<li><p>For each observation, the 2.5% and 97.5% quantiles form the <strong>95% prediction intervals</strong>.</p></li>
<li><p>The plot now shows:</p>
<ul>
<li><strong>Thick lines</strong> for mean confidence intervals,</li>
<li><strong>Thin lines</strong> for prediction intervals,</li>
<li><strong>Green points</strong> for covered observations,</li>
<li><strong>Red points</strong> for uncovered observations.</li>
</ul></li>
</ol>
<p>Finally, the empirical coverage rate of the prediction intervals is printed.</p>
</details>
<p>The <strong>prediction intervals</strong> now achieve a coverage much closer to 95%, as expected.
This reflects the inclusion of both <strong>estimation uncertainty</strong> and <strong>random variability</strong>.</p>
<p>Because bootstrap resampling involves randomness, running the code again will produce slightly different numerical results—an inherent feature of resampling methods.</p>

</div>
</div>
</div>
            </section>

          </div>
        </div>
      </div>
<a href="multiple-linear-regression.html" class="navigation navigation-prev " aria-label="Previous page"><i class="fa fa-angle-left"></i></a>
<a href="mean-and-varaince-assumptions.html" class="navigation navigation-next " aria-label="Next page"><i class="fa fa-angle-right"></i></a>
    </div>
  </div>
<script src="libs/gitbook-2.6.7/js/app.min.js"></script>
<script src="libs/gitbook-2.6.7/js/clipboard.min.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-search.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-sharing.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-fontsettings.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-bookdown.js"></script>
<script src="libs/gitbook-2.6.7/js/jquery.highlight.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-clipboard.js"></script>
<script>
gitbook.require(["gitbook"], function(gitbook) {
gitbook.start({
"sharing": {
"github": false,
"facebook": true,
"twitter": true,
"linkedin": false,
"weibo": false,
"instapaper": false,
"vk": false,
"whatsapp": false,
"all": ["facebook", "twitter", "linkedin", "weibo", "instapaper"]
},
"fontsettings": {
"theme": "white",
"family": "sans",
"size": 2
},
"edit": {
"link": null,
"text": null
},
"history": {
"link": null,
"text": null
},
"view": {
"link": null,
"text": null
},
"download": null,
"search": {
"engine": "fuse",
"options": null
},
"toc": {
"collapse": "subsection"
}
});
});
</script>

<!-- dynamically load mathjax for compatibility with self-contained -->
<script>
  (function () {
    var script = document.createElement("script");
    script.type = "text/javascript";
    var src = "true";
    if (src === "" || src === "true") src = "https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.9/latest.js?config=TeX-MML-AM_CHTML";
    if (location.protocol !== "file:")
      if (/^https?:/.test(src))
        src = src.replace(/^https?:/, '');
    script.src = src;
    document.getElementsByTagName("head")[0].appendChild(script);
  })();
</script>
</body>

</html>
